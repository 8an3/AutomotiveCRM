"use strict";Object.defineProperty(exports, "__esModule", {value: true});

var _IRSBF3C5cjs = require('./IRSBF3C5.cjs');


var _W5PBA4D6cjs = require('./W5PBA4D6.cjs');




var _7NAIPZYNcjs = require('./7NAIPZYN.cjs');




var _NREUHWTUcjs = require('./NREUHWTU.cjs');




var _6455U47Tcjs = require('./6455U47T.cjs');

// src/popover/popover.tsx
var _react = require('react');
var _jsxruntime = require('react/jsx-runtime');
var usePopover = _7NAIPZYNcjs.createHook.call(void 0, 
  (_a) => {
    var _b = _a, {
      store,
      modal = false,
      portal = !!modal,
      preserveTabOrder = true,
      autoFocusOnShow = true,
      wrapperProps
    } = _b, props = _6455U47Tcjs.__objRest.call(void 0, _b, [
      "store",
      "modal",
      "portal",
      "preserveTabOrder",
      "autoFocusOnShow",
      "wrapperProps"
    ]);
    const popoverElement = store.useState("popoverElement");
    const contentElement = store.useState("contentElement");
    _NREUHWTUcjs.useSafeLayoutEffect.call(void 0, () => {
      const wrapper = popoverElement;
      const popover = contentElement;
      if (!wrapper)
        return;
      if (!popover)
        return;
      wrapper.style.zIndex = getComputedStyle(popover).zIndex;
    }, [popoverElement, contentElement]);
    const [canAutoFocusOnShow, setCanAutoFocusOnShow] = _react.useState.call(void 0, false);
    const { portalRef, domReady } = _NREUHWTUcjs.usePortalRef.call(void 0, portal, props.portalRef);
    const mounted = store.useState("mounted");
    _NREUHWTUcjs.useSafeLayoutEffect.call(void 0, () => {
      if (!domReady)
        return;
      if (!mounted)
        return;
      if (!(contentElement == null ? void 0 : contentElement.isConnected))
        return;
      const raf = requestAnimationFrame(() => {
        setCanAutoFocusOnShow(true);
      });
      return () => {
        cancelAnimationFrame(raf);
      };
    }, [domReady, mounted, contentElement]);
    const position = store.useState(
      (state) => state.fixed ? "fixed" : "absolute"
    );
    props = _NREUHWTUcjs.useWrapElement.call(void 0, 
      props,
      (element) => /* @__PURE__ */ _jsxruntime.jsx.call(void 0, 
        "div",
        _6455U47Tcjs.__spreadProps.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {
          role: "presentation"
        }, wrapperProps), {
          style: _6455U47Tcjs.__spreadValues.call(void 0, {
            position,
            top: 0,
            left: 0
          }, wrapperProps == null ? void 0 : wrapperProps.style),
          ref: store.setPopoverElement,
          children: element
        })
      ),
      [store, position, wrapperProps]
    );
    props = _NREUHWTUcjs.useWrapElement.call(void 0, 
      props,
      (element) => /* @__PURE__ */ _jsxruntime.jsx.call(void 0, _W5PBA4D6cjs.PopoverContext.Provider, { value: store, children: element }),
      [store]
    );
    props = _6455U47Tcjs.__spreadProps.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {}, props), {
      style: _6455U47Tcjs.__spreadValues.call(void 0, {
        position: "relative"
      }, props.style)
    });
    props = _IRSBF3C5cjs.useDialog.call(void 0, _6455U47Tcjs.__spreadProps.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {
      store,
      modal,
      preserveTabOrder,
      portal,
      autoFocusOnShow: canAutoFocusOnShow && autoFocusOnShow
    }, props), {
      portalRef
    }));
    return props;
  }
);
var Popover = _7NAIPZYNcjs.createComponent.call(void 0, (props) => {
  const htmlProps = usePopover(props);
  return _7NAIPZYNcjs.createElement.call(void 0, "div", htmlProps);
});
if (process.env.NODE_ENV !== "production") {
  Popover.displayName = "Popover";
}




exports.usePopover = usePopover; exports.Popover = Popover;
