"use strict";Object.defineProperty(exports, "__esModule", {value: true});

var _SDBF6KIYcjs = require('../__chunks/SDBF6KIY.cjs');
require('../__chunks/HEFJPUYD.cjs');


var _27ZAGOYGcjs = require('../__chunks/27ZAGOYG.cjs');


var _6SPJEESBcjs = require('../__chunks/6SPJEESB.cjs');


var _M6ZA7XUPcjs = require('../__chunks/M6ZA7XUP.cjs');



var _6455U47Tcjs = require('../__chunks/6455U47T.cjs');

// src/tooltip/tooltip-store.ts
var tooltips = _6SPJEESBcjs.createStore.call(void 0, { activeRef: null });
function afterTimeout(timeoutMs, cb) {
  const timeoutId = setTimeout(cb, timeoutMs);
  return () => clearTimeout(timeoutId);
}
function createTooltipStore(props = {}) {
  var _a;
  const syncState = (_a = props.store) == null ? void 0 : _a.getState();
  const open = _M6ZA7XUPcjs.defaultValue.call(void 0, props.open, syncState == null ? void 0 : syncState.open, false);
  const disclosure = _27ZAGOYGcjs.createDisclosureStore.call(void 0, _6455U47Tcjs.__spreadProps.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {}, props), { open }));
  const popover = _SDBF6KIYcjs.createPopoverStore.call(void 0, _6455U47Tcjs.__spreadProps.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {}, props), {
    open,
    placement: _M6ZA7XUPcjs.defaultValue.call(void 0, 
      props.placement,
      syncState == null ? void 0 : syncState.placement,
      "top"
    ),
    gutter: _M6ZA7XUPcjs.defaultValue.call(void 0, props.gutter, syncState == null ? void 0 : syncState.gutter, 8)
  }));
  const initialState = _6455U47Tcjs.__spreadProps.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {}, popover.getState()), {
    timeout: _M6ZA7XUPcjs.defaultValue.call(void 0, props.timeout, syncState == null ? void 0 : syncState.timeout, 0)
  });
  const tooltip = _6SPJEESBcjs.createStore.call(void 0, 
    initialState,
    popover,
    disclosure.omit("open", "mounted"),
    props.store
  );
  const ref = Symbol();
  tooltip.setup(
    () => disclosure.sync(
      (state, prev) => {
        const { timeout } = tooltip.getState();
        const { activeRef } = tooltips.getState();
        if (state.open) {
          if (!timeout || activeRef) {
            tooltips.setState("activeRef", ref);
            tooltip.setState("open", true);
            return;
          } else {
            tooltips.setState("activeRef", null);
            return afterTimeout(timeout, () => {
              tooltips.setState("activeRef", ref);
            });
          }
        } else if (state.open !== prev.open) {
          tooltip.setState("open", false);
          return afterTimeout(timeout, () => {
            tooltips.setState(
              "activeRef",
              (activeRef2) => activeRef2 === ref ? null : activeRef2
            );
          });
        }
        return;
      },
      ["open"]
    )
  );
  tooltip.setup(
    () => tooltips.sync(
      (state) => {
        tooltip.setState("open", state.activeRef === ref);
      },
      ["activeRef"]
    )
  );
  tooltip.setup(() => () => {
    tooltips.setState(
      "activeRef",
      (activeRef) => activeRef === ref ? null : activeRef
    );
  });
  return _6455U47Tcjs.__spreadValues.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, _6455U47Tcjs.__spreadValues.call(void 0, {}, popover), disclosure), tooltip);
}


exports.createTooltipStore = createTooltipStore;
